<?xml version="1.0" encoding="UTF-8"?>


<!-- ==== #29. mapper 기본설정 ==== -->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="hr">

	<!--  resultMap의 값은 id 값으로 매핑된다.
	      property는 해쉬맵의 키값
	      column은 실제 값
	      
	      키값과 컬럼값을 구분지으려 일브로 앞자리 대문자를 지어줌.
	      원래는 안바꿈.
	 -->
	 
	 
	<resultMap type="HashMap" id="employeesMap">
		<result property="employee_id" column="employee_id" javaType="String"/>
		<result property="ename" column="ename" javaType="String"/>
		<result property="yearpay" column="yearpay" javaType="String"/>
		<result property="gender" column="gender" javaType="String"/>
		<result property="age" column="age" javaType="String"/>
	</resultMap>
	
	<select id="test_employees" resultMap="employeesMap">
	select employee_id, first_name || ' ' || last_name AS ename,
       nvl( (salary + salary*commission_pct)*12 ,  salary*12) AS yearpay,
       case when substr(jubun,7,1) in ('1','3') then '남' else '여' end AS gender,
       extract(year from sysdate) - ( case when substr(jubun,7,1) in('1','2') then 1900 else 2000 end + to_number(substr(jubun,1,2)) ) + 1 AS age        
	   from employees
	   order by 1
	</select> 
	

		
</mapper>
